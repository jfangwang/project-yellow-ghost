(this["webpackJsonpproject-yellow-ghost"]=this["webpackJsonpproject-yellow-ghost"]||[]).push([[0],{100:function(e,t,s){"use strict";s.r(t);var i=s(4),n=s.n(i),c=s(42),a=s.n(c),r=s(21),l=s(22),o=s(23),d=s(27),u=s(26),m=s(36),j=s(45),h=s.n(j),g=s(46),_=s(11),b=(s(92),s(102),s(94),s(103),s(101),s(104),_.a.initializeApp({apiKey:"AIzaSyAzNigqy7stltnVUU8cAollxCxvW0CNBTE",authDomain:"ghost-f8b34.firebaseapp.com",projectId:"ghost-f8b34",storageBucket:"ghost-f8b34.appspot.com",messagingSenderId:"838623299070",appId:"1:838623299070:web:b73429fee525b7c01cacaf",measurementId:"G-85ZG5FVKQ4"}).firestore()),f=_.a.auth(),p=_.a.storage(),O=new _.a.auth.GoogleAuthProvider,x=(s(97),s(20),s(10)),v=s(2);function N(e){var t=Object(i.useState)(!1),s=Object(x.a)(t,2),n=s[0],c=s[1],a=b.collection("users").doc(e.user_email);return Object(v.jsxs)("li",{className:"add-friends-content",children:[Object(v.jsxs)("div",{className:"add-box-1",children:[Object(v.jsx)("img",{className:"message-avatar",src:e.friend_pic,alt:"Avatar"}),Object(v.jsxs)("ul",{className:"message-info",children:[Object(v.jsx)("h3",{children:e.friend_name}),Object(v.jsx)("p",{children:e.friend_username})]})]}),Object(v.jsx)("div",{className:"add-box-2",children:n?Object(v.jsx)("p",{className:"removed",children:Object(v.jsx)("b",{children:"Removed!"})}):Object(v.jsx)("button",{onClick:function(){e.friends_list.splice(e.friends_list.indexOf(e.friend_username),1),a.update({friends:e.friends_list}),c(!0)},children:Object(v.jsx)("b",{children:"Remove"})})})]})}function w(e){var t=Object(i.useState)(!1),s=Object(x.a)(t,2),n=s[0],c=s[1],a=b.collection("users").doc(e.user_email);return Object(v.jsxs)("li",{className:"add-friends-content",children:[Object(v.jsxs)("div",{className:"add-box-1",children:[Object(v.jsx)("img",{className:"message-avatar",src:e.stranger_pic,alt:"Avatar"}),Object(v.jsxs)("ul",{className:"message-info",children:[Object(v.jsx)("h3",{children:e.stranger_name}),Object(v.jsx)("p",{children:e.stranger_username})]})]}),Object(v.jsx)("div",{className:"add-box-2",children:n?Object(v.jsx)("p",{className:"added",children:Object(v.jsx)("b",{children:"Added!"})}):Object(v.jsx)("button",{onClick:function(){e.friends_list.push(e.stranger_username),a.update({friends:e.friends_list}),c(!0)},children:Object(v.jsx)("b",{children:"Add"})})})]})}function k(e){return Object(v.jsxs)("li",{className:"add-friends-content",children:[Object(v.jsxs)("div",{className:"add-box-1",children:[Object(v.jsx)("img",{className:"message-avatar",src:e.stranger_pic,alt:"Avatar"}),Object(v.jsxs)("ul",{className:"message-info",children:[Object(v.jsx)("h3",{children:e.stranger_name}),Object(v.jsx)("p",{children:e.stranger_username})]})]}),Object(v.jsx)("div",{className:"add-box-2"})]})}function S(e){var t=Object(i.useState)(!1),s=Object(x.a)(t,2),n=s[0],c=s[1];return Object(v.jsxs)(v.Fragment,{children:[n?null:Object(v.jsxs)("div",{className:"navbar",children:[Object(v.jsx)("div",{className:"nav-box-1",children:Object(v.jsxs)("ul",{children:[Object(v.jsx)("li",{children:"Guest"==e.user_name?Object(v.jsx)("a",{onClick:e.login,children:"Sign In"}):Object(v.jsx)("img",{className:"profile-pic",src:e.user_pic,onClick:e.logout,alt:"Profile Picture"})}),Object(v.jsx)("li",{children:Object(v.jsx)("a",{children:"Search"})})]})}),Object(v.jsx)("div",{className:"nav-box-2",children:Object(v.jsx)("h1",{children:"Chat"})}),Object(v.jsx)("div",{className:"nav-box-3",children:Object(v.jsxs)("ul",{children:[Object(v.jsx)("li",{children:Object(v.jsx)("a",{onClick:function(){e.get_friends_list(),c(!0)},children:"Add Friend"})}),Object(v.jsx)("li",{children:Object(v.jsx)("a",{children:"New Chat"})})]})})]}),n&&null!=e.user_strangers_dict&&null!=e.user_friends_dict&&null!=e.everyone_dict?Object(v.jsxs)("div",{className:"add-friends",children:[Object(v.jsxs)("div",{className:"add-navbar",children:[Object(v.jsx)("div",{className:"nav-box-1",children:Object(v.jsx)("ul",{children:Object(v.jsx)("li",{children:Object(v.jsx)("a",{onClick:function(){e.get_friends_list(),c(!1)},children:Object(v.jsx)("b",{children:"Close"})})})})}),Object(v.jsx)("div",{className:"nav-box-2",children:Object(v.jsx)("h1",{children:"Add Friends"})}),Object(v.jsx)("div",{className:"nav-box-3",children:Object(v.jsx)("ul",{children:Object(v.jsx)("li",{children:Object(v.jsx)("a",{children:Object(v.jsx)("b",{children:". . ."})})})})})]}),Object(v.jsxs)("div",{className:"add-body",children:[Object(v.jsx)("div",{className:"search-bar",children:Object(v.jsx)("input",{type:"search",placeholder:"Find Friends"})}),Object(v.jsx)("div",{className:"add-title-navbar",children:Object(v.jsxs)("h3",{className:"quick-add",children:["Quick Add (",e.logged_in?e.user_strangers_dict.length:0,")"]})}),Object(v.jsx)("ul",{className:"add-list list-container",children:e.logged_in?e.user_strangers_dict.map((function(t){return Object(v.jsx)(w,{stranger_pic:t.photoURL,stranger_name:t.name,stranger_username:t.email,friends_list:e.friends_list,user_email:e.user_email,get_friends_list:e.get_friends_list})})):null}),Object(v.jsx)("div",{className:"add-title-navbar",children:Object(v.jsxs)("h3",{className:"quick-add",children:["Friends (",e.user_friends_dict.length,")"]})}),Object(v.jsx)("ul",{className:"add-list list-container",children:e.user_friends_dict.map((function(t){return Object(v.jsx)(N,{friend_pic:t.photoURL,friend_name:t.name,friend_username:t.email,friends_list:e.friends_list,user_email:e.user_email,get_friends_list:e.get_friends_list})}))}),Object(v.jsx)("div",{className:"add-title-navbar",children:Object(v.jsxs)("h3",{className:"quick-add",children:["Everyone (",e.everyone_dict.length,")"]})}),Object(v.jsx)("ul",{className:"add-list list-container",children:e.everyone_dict.map((function(e){return Object(v.jsx)(k,{stranger_pic:e.photoURL,stranger_name:e.name,stranger_username:e.email})}))}),Object(v.jsx)("div",{className:"add-footer"})]})]}):null]})}var y=s(48);function C(e){var t=Object(i.useState)("Received"),s=Object(x.a)(t,2),n=s[0],c=s[1],a=Object(i.useState)(0),r=Object(x.a)(a,2),l=r[0],o=r[1],d=Object(i.useState)([]),u=Object(x.a)(d,2),m=(u[0],u[1],function(){b.collection("posts").doc(e.user_email).collection("Received").orderBy("timeStamp","desc").onSnapshot((function(t){for(var s=0;s<t.docs.length&&t.docs[s].data().email!=e.sender_email;)s+=1;s<t.docs.length&&t.docs[s].data().email==e.sender_email?(c("New Snap"),null!=t.docs[s].data().timeStamp&&o(t.docs[s].data().timeStamp.toDate().toUTCString())):c("Received")}))}),j=Object(v.jsx)("p",{children:n}),h=Object(v.jsx)("div",{className:"message-received"});"New Snap"===n?(h=Object(v.jsx)("div",{className:"message-new"}),j=Object(v.jsx)("p",{className:"red",children:Object(v.jsx)("b",{children:n})})):"Received"===n?h=Object(v.jsx)("div",{className:"message-received"}):"Sent"===n?h=Object(v.jsx)("div",{className:"message-sent"}):"Opened"===n&&(h=Object(v.jsx)("div",{className:"message-opened"}));var g=Object(i.useState)(null),_=Object(x.a)(g,2),f=_[0],O=_[1],N=Object(i.useState)(null),w=Object(x.a)(N,2),k=w[0],S=w[1];return Object(i.useEffect)((function(){m()})),Object(v.jsx)(v.Fragment,{children:f?Object(v.jsx)("div",{className:"image-background",onClick:function(){O(null),b.collection("posts").doc(e.user_email).collection("Received").doc(k).delete().then((function(){console.log("Document deleted")})).catch((function(e){console.log("Error removing document: ",e)})),m();var t=b.collection("posts").doc(e.sender_email).collection("Sent").doc(k);t.get().then((function(s){if(1==s.data().to.length)t.delete().then((function(){console.log("sender document deleted, everyone saw the pic")})).catch((function(e){console.log("Could not delete sender's document")})),p.ref("posts/".concat(k)).delete().then((function(e){console.log("Deleted from storage: ",k)})).catch((function(e){console.log("TRIED DELETING: ",k)})),b.collection("posts").doc(k).delete().then((function(){console.log("Deleted from firestore")})).catch((function(e){console.error("Error removing document: ",e)}));else{var i=0,n=[];for(i=0;i<s.data().to.length;i+=1)s.data().to[i]!=e.user_email&&(n[i]=s.data().to[i]);t.update({to:n}).then((function(){console.log("Updated sender's list")})).catch((function(e){console.log("could not update list: ",e)}))}}))},children:Object(v.jsx)("img",{className:"image",src:f})}):Object(v.jsxs)("li",{className:"message-content",onClick:function(){console.log("opening snap",e.user_email),b.collection("posts").doc(e.user_email).collection("Received").orderBy("timeStamp","desc").get().then((function(t){for(var s=0;s<t.docs.length&&t.docs[s].data().email!=e.sender_email;)s+=1;s<t.docs.length&&t.docs[s].data().email==e.sender_email?null!=t.docs[s].data()&&(O(t.docs[s].data().imageURL),S(t.docs[s].data().id)):c("Received")}))},children:[Object(v.jsx)("img",{className:"message-avatar",src:e.profile_url,alt:"Avatar"}),Object(v.jsxs)("ul",{className:"message-info",children:[Object(v.jsx)("h3",{children:e.sender_name}),Object(v.jsxs)("div",{className:"message-sub-info",children:[h,j,0!=l?Object(v.jsx)("p",{children:Object(v.jsx)(y.a,{date:l,locale:"en-US"})}):null,e.streak_num>0?Object(v.jsxs)("p",{children:[e.streak_num,e.streak_emoji]}):null]})]})]})})}var R=function(e){return Object(v.jsxs)("div",{className:"messages-screen",children:[Object(v.jsx)(S,{user_email:e.user_email,user_name:e.user_name,user_pic:e.user_pic,login:e.login,logout:e.logout,user_friends_dict:e.user_friends_dict,user_strangers_dict:e.user_strangers_dict,everyone_dict:e.everyone_dict,get_friends_list:e.get_friends_list,get_all_users:e.get_all_users,friends_list:e.friends_list,logged_in:e.logged_in}),Object(v.jsxs)("ul",{className:"messages-list",children:[e.logged_in?null:Object(v.jsx)("li",{className:"welcome-statement",children:"Welcome to Project Yellow Ghost, a web app version of SnapChat. This was a project developed by Jonathan Wang and this was his final project for school. Right now, you are on a local guest account for you to try out. Feel free to sign in at the top if you want to start using this product. Happy Snapping!"}),e.user_friends_dict.map((function(t){return Object(v.jsx)(C,{sender_email:t.email,profile_url:t.photoURL,sender_name:t.name,user_email:e.user_email,streak_emoji:e.streak_emoji,logged_in:e.logged_in})}))]})]})},U=s(47),A=s.n(U),L=s(107),G=(s(99),function(e){Object(d.a)(s,e);var t=Object(u.a)(s);function s(e){var i;return Object(r.a)(this,s),(i=t.call(this,e)).update=function(){i.setState({width:window.innerWidth,height:window.innerHeight,faceMode:"user"})},i.send=function(){var e=_.a.auth().currentUser,t=Object(L.a)(),s=e.email,n=e.displayName,c=[s];p.ref("posts/".concat(t)).putString(i.state.image,"data_url").on("state_changed",(function(e){}),(function(e){console.log(e)}),(function(){var e=0;for(e=0;e<c.length;e++){console.log(typeof c[e],c[e]);var a=c[e];p.ref("posts").child(t).getDownloadURL().then((function(e){b.collection("posts").doc(a).collection("Received").doc(t).set({imageURL:e,id:t,email:s,name:n,avatarURL:"https://upload.wikimedia.org/wikipedia/commons/thumb/7/7e/Circle-icons-profile.svg/2048px-Circle-icons-profile.svg.png",read:!1,timeStamp:_.a.firestore.FieldValue.serverTimestamp(),to:c}),console.log("Photo Sent"),i.setState({image:null,screen:"camera"})}))}b.collection("posts").doc(s).collection("Sent").doc(t).set({id:t,email:s,timeStamp:_.a.firestore.FieldValue.serverTimestamp(),to:c})}))},i.close=function(){i.setState({image:null,screen:"camera"})},i.send_to=function(){i.setState({screen:"send_to"})},i.capture=function(){var e=i.webcam.getScreenshot();i.setState({image:e,screen:"captured"})},i.setRef=function(e){i.webcam=e},i.state={width:window.innerWidth,height:window.innerHeight,image:null,screen:"camera"},window.addEventListener("resize",i.update),i}return Object(l.a)(s,[{key:"render",value:function(){return Object(v.jsxs)(v.Fragment,{children:["camera"===this.state.screen?Object(v.jsxs)("div",{className:"cam-tab",children:[Object(v.jsx)(A.a,{ref:this.setRef,videoConstraints:{facingMode:this.state.faceMode,width:this.state.width,height:this.state.height},screenshotFormat:"image/jpeg",audio:!1,mirrored:!0,className:"webcam"}),Object(v.jsx)("button",{className:"capture",onClick:this.capture,children:"Capture"})]}):null,"captured"===this.state.screen&&this.state.image?Object(v.jsxs)("div",{className:"cam-tab",children:[Object(v.jsx)("img",{src:this.state.image}),Object(v.jsx)("button",{className:"capture",onClick:this.send_to,children:"Send to"}),Object(v.jsx)("button",{className:"send",onClick:this.close,children:"Close"})]}):null,"send_to"===this.state.screen&&this.state.image?Object(v.jsxs)("div",{className:"user-list",children:[Object(v.jsx)("button",{className:"send",onClick:this.send,children:"Send"}),Object(v.jsx)("button",{className:"capture",onClick:this.close,children:"Close"})]}):null]})}}]),s}(i.Component)),E=Object(g.bindKeyboard)(h.a),F="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7e/Circle-icons-profile.svg/2048px-Circle-icons-profile.svg.png",D={email:"Guest@project-yellow-ghost.com",name:"Guest",photoURL:F,streak_emoji:"\ud83d\udd25",imgs_sent:0,imgs_received:0,friends:["Guest@project-yellow-ghost.com"]},I=function(e){Object(d.a)(s,e);var t=Object(u.a)(s);function s(e){var i;return Object(r.a)(this,s),(i=t.call(this,e)).update=function(){i.setState({width:window.innerWidth,height:window.innerHeight})},i.login=function(){f.signInWithPopup(O).then((function(e){i.setState({logged_in:!0,user_name:e.user.displayName,user_email:e.user.email,user_pic:e.user.photoURL,user_friends:[e.user.email]},i.get_friends_list)})).catch((function(e){return console.log(e.message)}))},i.logout=function(){_.a.auth().signOut(),i.setState({logged_in:!1,streak_emoji:"\ud83d\udd25",user_name:"Guest",user_email:"Guest",user_friends_dict:[D],user_strangers_dict:null,everyone_dict:[D],user_pic:"https://upload.wikimedia.org/wikipedia/commons/thumb/7/7e/Circle-icons-profile.svg/2048px-Circle-icons-profile.svg.png"})},i.check_user=function(){_.a.auth().onAuthStateChanged(function(e){e&&this.setState({user_name:e.displayName,user_email:e.email,user_pic:e.photoURL,logged_in:!0},this.get_friends_list)}.bind(Object(o.a)(i)))},i.get_friends_list=function(){b.collection("users").doc(i.state.user_email).get().then((function(e){e.exists?i.setState({user_friends:e.data().friends,imgs_sent:e.data().imgs_sent,imgs_received:e.data().imgs_received,streak_emoji:e.data().streak_emoji},i.get_all_users):(b.collection("users").doc(i.state.user_email).set({email:i.state.user_email,name:i.state.user_name,photoURL:i.state.user_pic,streak_emoji:i.state.streak_emoji,imgs_sent:0,imgs_received:0,friends:[i.state.user_email]}).catch((function(e){console.log("Couldn't write user to DB, error: ",e)})),i.get_all_users())})).catch((function(e){console.log("Error getting document:",e)}))},i.get_all_users=function(){var e=[],t=[],s=[],n=0,c=0,a=0;b.collection("users").get().then((function(r){for(var l=0;l<r.docs.length;l++)i.state.user_friends.includes(r.docs[l].data().email)?(e[n]=r.docs[l].data(),n+=1):(t[c]=r.docs[l].data(),c+=1),s[a]=r.docs[l].data(),a+=1;i.setState({user_friends_dict:e,user_strangers_dict:t,everyone_dict:s})}))},i.state={index:0,height:window.innerHeight,width:window.innerWidth,logged_in:!1,user_friends_dict:[D],user_strangers_dict:null,everyone_dict:[D],user_email:"Guest",user_name:"Guest",user_pic:F,streak_emoji:"\ud83d\udd25",imgs_sent:0,imgs_received:0,user_friends:["Guest@mail"]},window.addEventListener("resize",i.update),i}return Object(l.a)(s,[{key:"componentDidMount",value:function(){this.check_user()}},{key:"render",value:function(){return Object(v.jsxs)(E,{enableMouseEvents:!0,style:Object.assign({width:this.state.width,height:this.state.height,position:"absolute",top:"0%",left:"0%"}),children:[Object(v.jsxs)("div",{style:Object.assign({backgroundColor:"white",minHeight:"100vh",width:"100%"}),children:[Object(v.jsx)(m.a,{children:Object(v.jsx)("meta",{name:"viewport",content:"height=device-height, width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"})}),Object(v.jsx)(R,{user_email:this.state.user_email,user_name:this.state.user_name,user_pic:this.state.user_pic,user_friends_dict:this.state.user_friends_dict,user_strangers_dict:this.state.user_strangers_dict,everyone_dict:this.state.everyone_dict,logged_in:this.state.logged_in,login:this.login.bind(this),logout:this.logout.bind(this),get_friends_list:this.get_friends_list.bind(this),get_all_users:this.get_all_users.bind(this),friends_list:this.state.user_friends,streak_emoji:this.state.streak_emoji})]}),Object(v.jsxs)("div",{style:Object.assign({backgroundColor:"Plum"}),children:[Object(v.jsx)(m.a,{children:Object(v.jsx)("meta",{name:"viewport",content:"height=device-height, width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes"})}),Object(v.jsx)(G,{})]})]})}}]),s}(n.a.Component);a.a.render(Object(v.jsx)(I,{}),document.getElementById("root"))},20:function(e,t,s){},97:function(e,t,s){},99:function(e,t,s){}},[[100,1,2]]]);
//# sourceMappingURL=main.72db6936.chunk.js.map