(this["webpackJsonpproject-yellow-ghost"]=this["webpackJsonpproject-yellow-ghost"]||[]).push([[0],{108:function(e,s,t){},211:function(e,s,t){},45:function(e,s,t){},508:function(e,s,t){"use strict";t.r(s);var i=t(5),c=t.n(i),n=t(28),a=t.n(n),r=t(152),l=t(153),d=t(67),o=t(164),j=t(163),u=t(154),m=t(157),_=t.n(m),h=t(158),b=t(15),g=(t(207),t(511),t(209),t(510),t(509),t(512),b.a.initializeApp({apiKey:"AIzaSyAzNigqy7stltnVUU8cAollxCxvW0CNBTE",authDomain:"ghost-f8b34.firebaseapp.com",projectId:"ghost-f8b34",storageBucket:"ghost-f8b34.appspot.com",messagingSenderId:"838623299070",appId:"1:838623299070:web:b73429fee525b7c01cacaf",measurementId:"G-85ZG5FVKQ4"}).firestore()),O=b.a.auth(),x=b.a.storage(),f=new b.a.auth.GoogleAuthProvider,p=(t(211),t(45),t(7)),v=t.p+"static/media/black-checkmark.d8439ac6.png",N=t(2);function k(e){var s=Object(i.useState)(!1),t=Object(p.a)(s,2),c=t[0],n=t[1],a=g.collection("users").doc(e.user_email);return Object(N.jsx)(N.Fragment,{children:e.friend_username==e.user_email?null:Object(N.jsxs)("li",{className:"add-friends-content",children:[Object(N.jsxs)("div",{className:"add-box-1",children:[Object(N.jsx)("img",{className:"message-avatar",src:e.friend_pic,alt:"Avatar"}),Object(N.jsxs)("ul",{className:"message-info",children:[Object(N.jsx)("h3",{children:e.friend_name}),Object(N.jsx)("p",{children:e.friend_username})]})]}),Object(N.jsx)("div",{className:"add-box-2",children:c?Object(N.jsx)("p",{className:"removed",children:Object(N.jsx)("b",{children:"Removed!"})}):Object(N.jsx)("button",{onClick:function(){"Guest@project-yellow-ghost.com"!=e.friend_username&&function(){e.friends_list.splice(e.friends_list.indexOf(e.friend_username),1),a.update({friends:e.friends_list}),g.collection("posts").doc(e.user_email).collection("Latest_Messages").doc(e.friend_username).delete();var s=[];g.collection("posts").doc(e.friend_username).collection("Latest_Messages").get().then((function(t){t.docs.forEach((function(e){s.push(e.data().email)})),s.includes(e.user_email)&&g.collection("posts").doc(e.friend_username).collection("Latest_Messages").doc(e.user_email).update({friend_since:null,status:"Friend broke up",streak_num:0,timeStamp:null})}))}(),n(!0)},children:Object(N.jsx)("b",{children:"Remove"})})})]})})}function w(e){var s=Object(i.useState)(!1),t=Object(p.a)(s,2),c=t[0],n=t[1];g.collection("users").doc(e.user_email);return Object(N.jsx)(N.Fragment,{children:c?Object(N.jsxs)("li",{className:"add-friends-content",onClick:function(){n(!1);var s=e.send_list;s.splice(s.indexOf(e.friend_username),1),e.handle_send_list(s)},children:[Object(N.jsxs)("div",{className:"add-box-1",children:[Object(N.jsx)("img",{className:"message-avatar",src:e.friend_pic,alt:"Avatar"}),Object(N.jsx)("ul",{className:"message-info",children:Object(N.jsx)("h2",{className:"selected",children:e.friend_name})})]}),Object(N.jsx)("div",{className:"add-box-2",children:Object(N.jsx)("div",{className:"selected selected-circle",children:Object(N.jsx)("img",{className:"checkmark",src:v,alt:"U+2713"})})})]}):Object(N.jsxs)("li",{className:"add-friends-content",onClick:function(){n(!0);var s=e.send_list;s.push(e.friend_username),e.handle_send_list(s)},children:[Object(N.jsxs)("div",{className:"add-box-1",children:[Object(N.jsx)("img",{className:"message-avatar",src:e.friend_pic,alt:"Avatar"}),Object(N.jsx)("ul",{className:"message-info",children:Object(N.jsx)("h2",{children:e.friend_name})})]}),Object(N.jsx)("div",{className:"add-box-2",children:Object(N.jsx)("div",{className:"unselected-circle",children:Object(N.jsx)("img",{className:"checkmark",src:v,alt:"U+2713"})})})]})})}function S(e){var s=Object(i.useState)(!1),t=Object(p.a)(s,2),c=t[0],n=t[1],a=g.collection("users").doc(e.user_email);return Object(N.jsxs)("li",{className:"add-friends-content",children:[Object(N.jsxs)("div",{className:"add-box-1",children:[Object(N.jsx)("img",{className:"message-avatar",src:e.stranger_pic,alt:"Avatar"}),Object(N.jsxs)("ul",{className:"message-info",children:[Object(N.jsx)("h3",{children:e.stranger_name}),Object(N.jsx)("p",{children:e.stranger_username})]})]}),Object(N.jsx)("div",{className:"add-box-2",children:c?Object(N.jsx)("p",{className:"added",children:Object(N.jsx)("b",{children:"Added!"})}):Object(N.jsx)("button",{onClick:function(){"Guest@project-yellow-ghost.com"!=e.friend_username&&function(){e.friends_list.push(e.stranger_username),a.update({friends:e.friends_list});var s=[];g.collection("posts").doc(e.stranger_username).collection("Latest_Messages").get().then((function(t){if(t.docs.forEach((function(e){s.push(e.data().email)})),s.includes(e.user_email)){console.log("New Friend Added!");var i=b.a.firestore.FieldValue.serverTimestamp();g.collection("posts").doc(e.user_email).collection("Latest_Messages").doc(e.stranger_username).set({email:e.stranger_username,name:e.stranger_name,photoURL:e.stranger_pic,imgs_sent:0,imgs_received:0,friend_since:i,status:"New Friend!",streak_num:0,timeStamp:null}),g.collection("posts").doc(e.stranger_username).collection("Latest_Messages").doc(e.user_email).update({friend_since:i,status:"New Friend!"})}else console.log("Pending..."),g.collection("posts").doc(e.user_email).collection("Latest_Messages").doc(e.stranger_username).set({email:e.stranger_username,name:e.stranger_name,photoURL:e.stranger_pic,imgs_sent:0,imgs_received:0,friend_since:null,status:"Pending",streak_num:0,timeStamp:null})}))}(),n(!0)},children:Object(N.jsx)("b",{children:"Add"})})})]})}function y(e){return Object(N.jsxs)("li",{className:"add-friends-content",children:[Object(N.jsxs)("div",{className:"add-box-1",children:[Object(N.jsx)("img",{className:"message-avatar",src:e.stranger_pic,alt:"Avatar"}),Object(N.jsxs)("ul",{className:"message-info",children:[e.stranger_username==e.user_email?Object(N.jsxs)("h3",{children:[e.stranger_name," (Me)"]}):Object(N.jsx)("h3",{children:e.stranger_name}),Object(N.jsx)("p",{children:e.stranger_username})]})]}),Object(N.jsx)("div",{className:"add-box-2"})]})}function C(e){var s=Object(i.useState)(!1),t=Object(p.a)(s,2),c=t[0],n=t[1];return Object(N.jsxs)(N.Fragment,{children:[c?null:Object(N.jsxs)("div",{className:"navbar",children:[Object(N.jsx)("div",{className:"nav-box-1",children:Object(N.jsxs)("ul",{children:[Object(N.jsx)("li",{children:"Guest"==e.user_name?Object(N.jsx)("a",{onClick:e.login,children:"Sign In"}):Object(N.jsx)("img",{className:"profile-pic",src:e.user_pic,onClick:e.logout,alt:"Profile Picture"})}),Object(N.jsx)("li",{children:Object(N.jsx)("a",{children:"Search"})})]})}),Object(N.jsx)("div",{className:"nav-box-2",children:Object(N.jsx)("h1",{children:"Chat"})}),Object(N.jsx)("div",{className:"nav-box-3",children:Object(N.jsxs)("ul",{children:[Object(N.jsx)("li",{children:Object(N.jsx)("a",{onClick:function(){e.get_friends_list(),n(!0)},children:"Add Friend"})}),Object(N.jsx)("li",{children:Object(N.jsx)("a",{children:"New Chat"})})]})})]}),c&&null!=e.user_strangers_dict&&null!=e.user_friends_dict&&null!=e.everyone_dict?Object(N.jsxs)("div",{className:"add-friends",children:[Object(N.jsxs)("div",{className:"add-navbar",children:[Object(N.jsx)("div",{className:"nav-box-1",children:Object(N.jsx)("ul",{children:Object(N.jsx)("li",{children:Object(N.jsx)("a",{onClick:function(){e.get_friends_list(),n(!1)},children:Object(N.jsx)("b",{children:"Close"})})})})}),Object(N.jsx)("div",{className:"nav-box-2",children:Object(N.jsx)("h1",{children:"Add Friends"})}),Object(N.jsx)("div",{className:"nav-box-3",children:Object(N.jsx)("ul",{children:Object(N.jsx)("li",{children:Object(N.jsx)("a",{children:Object(N.jsx)("b",{children:". . ."})})})})})]}),Object(N.jsxs)("div",{className:"add-body",children:[Object(N.jsx)("div",{className:"search-bar",children:Object(N.jsx)("input",{type:"search",placeholder:"Find Friends"})}),Object(N.jsx)("div",{className:"add-title-navbar",children:Object(N.jsxs)("h3",{className:"quick-add",children:["Quick Add (",e.user_strangers_dict.length,")"]})}),Object(N.jsx)("ul",{className:"add-list list-container",children:e.user_strangers_dict.map((function(s){return Object(N.jsx)(S,{stranger_pic:s.photoURL,stranger_name:s.name,stranger_username:s.email,friend_username:s.email,friends_list:e.friends_list,user_email:e.user_email,get_friends_list:e.get_friends_list})}))}),Object(N.jsx)("div",{className:"add-title-navbar",children:Object(N.jsxs)("h3",{className:"quick-add",children:["Friends (",e.user_friends_dict.length-1,")"]})}),Object(N.jsx)("ul",{className:"add-list list-container",children:e.user_friends_dict.map((function(s){return Object(N.jsx)(k,{friend_pic:s.photoURL,friend_name:s.name,friend_username:s.email,friends_list:e.friends_list,user_email:e.user_email,get_friends_list:e.get_friends_list})}))}),Object(N.jsx)("div",{className:"add-title-navbar",children:Object(N.jsxs)("h3",{className:"quick-add",children:["Everyone (",e.everyone_dict.length,")"]})}),Object(N.jsx)("ul",{className:"add-list list-container",children:e.everyone_dict.map((function(s){return Object(N.jsx)(y,{stranger_pic:s.photoURL,stranger_name:s.name,stranger_username:s.email,user_email:e.user_email})}))}),Object(N.jsx)("div",{className:"add-footer"})]})]}):null]})}var L=t(162);function R(e){var s=Object(i.useState)(null),t=Object(p.a)(s,2),c=t[0],n=t[1],a=Object(i.useState)(null),r=Object(p.a)(a,2),l=r[0],d=r[1],o=Object(i.useState)(null),j=Object(p.a)(o,2),u=j[0],m=j[1],_=Object(i.useState)(null),h=Object(p.a)(_,2),b=h[0],O=h[1],f=Object(i.useState)("Received"),v=Object(p.a)(f,2),k=v[0],w=v[1],S=Object(i.useState)(null),y=Object(p.a)(S,2),C=(y[0],y[1]),R=Object(i.useState)(null),U=Object(p.a)(R,2),F=U[0],A=U[1],G=Object(i.useState)(null),E=Object(p.a)(G,2),M=(E[0],E[1],g.collection("posts").doc(e.user_email).collection("Received").doc(e.sender_email).collection("images")),P=g.collection("posts").doc(e.sender_email).collection("Sent"),q=g.collection("posts").doc(e.user_email).collection("Latest_Messages").doc(e.sender_email),I=g.collection("posts").doc(e.sender_email).collection("Latest_Messages").doc(e.user_email),T=null;"Guest@project-yellow-ghost.com"!==e.sender_email&&q.onSnapshot((function(e){m(e.data().imgs_sent),O(e.data().imgs_received),w(e.data().status),C(e.data().streak_num);try{A(e.data().timeStamp.toDate().toUTCString())}catch(s){}d(e.data().id),T=e.data().imageURL}));var B=function(){P.doc(l).get().then((function(s){if(s.data()&&1!=s.data().to.length){var t=s.data().to;t.splice(t.indexOf(e.user_email),1),P.doc(l).update({to:t}),M.doc(l).delete()}else x.ref("posts/".concat(l)).delete(),P.doc(l).delete(),M.doc(l).delete();M.orderBy("timeStamp","desc").get().then((function(e){I.update({id:null,imageURL:null,imgs_sent:0,status:"Opened"}),e.docs.length>0?q.update({id:e.docs[0].data().id,imageURL:e.docs[0].data().imageURL,imgs_received:b+1,status:"New Snap",timeStamp:e.docs[0].data().timeStamp}):q.update({id:null,imageURL:null,imgs_received:u+1,status:"Received"})}))}))},D=Object(N.jsx)("p",{children:k}),W=Object(N.jsx)("div",{className:""});return"New Snap"===k?(W=Object(N.jsx)("div",{className:"message-new"}),D=Object(N.jsx)("p",{className:"red",children:Object(N.jsx)("b",{children:k})})):"Received"===k?W=Object(N.jsx)("div",{className:"message-received"}):"Sent"===k?W=Object(N.jsx)("div",{className:"message-sent"}):"Opened"===k?W=Object(N.jsx)("div",{className:"message-opened"}):"New Friend!"==k&&(W=Object(N.jsx)("div",{className:"message-new-friend"})),Object(N.jsx)(N.Fragment,{children:c?Object(N.jsx)("div",{className:"image-background",onClick:function(){n(null)},children:Object(N.jsx)("img",{id:"image",className:"image-preview",src:c})}):Object(N.jsxs)("li",{className:"message-content",onClick:function(){"New Snap"==k&&(n(T),B())},children:[Object(N.jsx)("img",{className:"message-avatar",src:e.profile_url,alt:"Avatar"}),Object(N.jsxs)("ul",{className:"message-info",children:[Object(N.jsx)("h3",{children:e.sender_name}),Object(N.jsxs)("div",{className:"message-sub-info",children:[W,D,null!=F?Object(N.jsx)("p",{children:Object(N.jsx)(L.a,{date:F,locale:"en-US"})}):null,e.streak_num>0?Object(N.jsxs)("p",{children:[e.streak_num,e.streak_emoji]}):null]})]})]})})}var U=function(e){return Object(N.jsxs)("div",{className:"messages-screen",children:[Object(N.jsx)(C,{user_email:e.user_email,user_name:e.user_name,user_pic:e.user_pic,login:e.login,logout:e.logout,user_friends_dict:e.user_friends_dict,user_strangers_dict:e.user_strangers_dict,everyone_dict:e.everyone_dict,get_friends_list:e.get_friends_list,get_all_users:e.get_all_users,friends_list:e.friends_list,logged_in:e.logged_in}),Object(N.jsxs)("ul",{className:"messages-list",children:[e.logged_in?null:Object(N.jsx)("li",{className:"welcome-statement",children:"Welcome to Project Yellow Ghost, a web app version of SnapChat. This was a project developed by Jonathan Wang and this was his final project for school. Right now, you are on a local guest account for you to try out. Feel free to sign in at the top if you want to start using this product. Happy Snapping!"}),e.user_friends_dict.map((function(s){return Object(N.jsx)(R,{sender_email:s.email,profile_url:s.photoURL,sender_name:s.name,user_email:e.user_email,streak_emoji:e.streak_emoji,logged_in:e.logged_in})}))]})]})},F=t(159),A=t.n(F),G=t(515);t(108);function E(e){var s=Object(i.useState)(!1),t=Object(p.a)(s,2),c=t[0],n=t[1];return Object(N.jsxs)(N.Fragment,{children:[c?null:Object(N.jsxs)("div",{className:"webcam-navbar",children:[Object(N.jsx)("div",{className:"nav-box-1",children:Object(N.jsxs)("ul",{children:[Object(N.jsx)("li",{children:"Guest"==e.user_name?Object(N.jsx)("a",{onClick:e.login,children:"Sign In"}):Object(N.jsx)("img",{className:"profile-pic",src:e.user_pic,onClick:e.logout,alt:"Profile Picture"})}),Object(N.jsx)("li",{children:Object(N.jsx)("a",{children:"Search"})})]})}),Object(N.jsx)("div",{className:"nav-box-3",children:Object(N.jsxs)("ul",{children:[Object(N.jsx)("li",{children:Object(N.jsx)("a",{onClick:function(){e.get_friends_list(),n(!0)},children:"Add Friend"})}),Object(N.jsx)("li",{children:Object(N.jsx)("a",{children:"Flip Camera"})})]})})]}),c&&null!=e.user_strangers_dict&&null!=e.user_friends_dict&&null!=e.everyone_dict?Object(N.jsxs)("div",{className:"add-friends",children:[Object(N.jsxs)("div",{className:"add-navbar",children:[Object(N.jsx)("div",{className:"nav-box-1",children:Object(N.jsx)("ul",{children:Object(N.jsx)("li",{children:Object(N.jsx)("a",{onClick:function(){e.get_friends_list(),n(!1)},children:Object(N.jsx)("b",{children:"Close"})})})})}),Object(N.jsx)("div",{className:"nav-box-2",children:Object(N.jsx)("h1",{children:"Add Friends"})}),Object(N.jsx)("div",{className:"nav-box-3",children:Object(N.jsx)("ul",{children:Object(N.jsx)("li",{children:Object(N.jsx)("a",{children:Object(N.jsx)("b",{children:". . ."})})})})})]}),Object(N.jsxs)("div",{className:"add-body",children:[Object(N.jsx)("div",{className:"search-bar",children:Object(N.jsx)("input",{type:"search",placeholder:"Find Friends"})}),Object(N.jsx)("div",{className:"add-title-navbar",children:Object(N.jsxs)("h3",{className:"quick-add",children:["Quick Add (",e.user_strangers_dict.length,")"]})}),Object(N.jsx)("ul",{className:"add-list list-container",children:e.user_strangers_dict.map((function(s){return Object(N.jsx)(S,{stranger_pic:s.photoURL,stranger_name:s.name,stranger_username:s.email,friend_username:s.email,friends_list:e.friends_list,user_email:e.user_email,user_name:e.user_name,user_pic:e.user_pic,get_friends_list:e.get_friends_list})}))}),Object(N.jsx)("div",{className:"add-title-navbar",children:Object(N.jsxs)("h3",{className:"quick-add",children:["Friends (",e.user_friends_dict.length-1,")"]})}),Object(N.jsx)("ul",{className:"add-list list-container",children:e.user_friends_dict.map((function(s){return Object(N.jsx)(k,{friend_pic:s.photoURL,friend_name:s.name,friend_username:s.email,friends_list:e.friends_list,user_email:e.user_email,get_friends_list:e.get_friends_list})}))}),Object(N.jsx)("div",{className:"add-title-navbar",children:Object(N.jsxs)("h3",{className:"quick-add",children:["Everyone (",e.everyone_dict.length,")"]})}),Object(N.jsx)("ul",{className:"add-list list-container",children:e.everyone_dict.map((function(e){return Object(N.jsx)(y,{stranger_pic:e.photoURL,stranger_name:e.name,stranger_username:e.email})}))}),Object(N.jsx)("div",{className:"add-footer"})]})]}):null]})}function M(e){var s=Object(i.useState)([]),t=Object(p.a)(s,2),n=t[0],a=t[1],r=Object(i.useState)(null),l=Object(p.a)(r,2),d=l[0],o=l[1],j=Object(i.useState)("user"),u=Object(p.a)(j,2),m=u[0],_=(u[1],Object(i.useState)("camera")),h=Object(p.a)(_,2),O=h[0],f=h[1],v=c.a.useRef(null),C=Object(i.useState)(16/9),L=Object(p.a)(C,2),R=(L[0],L[1]),U=Object(i.useState)(!1),F=Object(p.a)(U,2),M=F[0],P=F[1],q=c.a.useCallback((function(){var e=v.current.getScreenshot();o(e),f("captured")}),[v]),I=function(e){var s=[];e.forEach((function(e){s.push(e)})),a(s),console.log(s)};return Object(i.useEffect)((function(){e.mobile?R(9/16):R(16/9)})),Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)("div",{className:"webcam-screen",children:[Object(N.jsx)(A.a,{id:"imageElement",className:"image-desktop",ref:v,audio:!1,mirrored:!0,forceScreenshotSourceSize:!1,screenshotFormat:"image/png",screenshotQuality:1,videoConstraints:{facingMode:m}}),"camera"===O?Object(N.jsxs)("div",{className:"webcam-overlay",children:[Object(N.jsx)(E,{user_email:e.user_email,user_name:e.user_name,user_pic:e.user_pic,login:e.login,logout:e.logout,user_friends_dict:e.user_friends_dict,user_strangers_dict:e.user_strangers_dict,everyone_dict:e.everyone_dict,get_friends_list:e.get_friends_list,get_all_users:e.get_all_users,friends_list:e.friends_list,logged_in:e.logged_in}),Object(N.jsx)("div",{className:"webcam-footer",children:Object(N.jsx)("div",{className:"nav-box-1",children:Object(N.jsxs)("ul",{children:[Object(N.jsx)("li",{children:Object(N.jsx)("a",{children:"Memories"})}),Object(N.jsx)("li",{children:Object(N.jsx)("a",{onClick:q,children:"Capture"})}),Object(N.jsx)("li",{children:Object(N.jsx)("a",{children:"Filters"})})]})})})]}):null,"captured"===O&&d?Object(N.jsxs)("div",{className:"captured-overlay",children:[Object(N.jsx)("div",{className:"image-preview",children:Object(N.jsx)("img",{id:"imageElement",className:"image-desktop",src:d})}),Object(N.jsxs)("div",{className:"buttons-overlay",children:[Object(N.jsxs)("div",{className:"captured-header",children:[Object(N.jsx)("div",{className:"header-left",children:Object(N.jsx)("ul",{children:Object(N.jsx)("li",{children:Object(N.jsx)("button",{className:"send",onClick:function(){o(null),f("camera")},children:"Close"})})})}),Object(N.jsx)("div",{className:"header-right",children:Object(N.jsxs)("ul",{children:[Object(N.jsx)("li",{children:Object(N.jsx)("button",{children:"Text"})}),Object(N.jsx)("li",{children:Object(N.jsx)("button",{children:"Draw"})}),Object(N.jsx)("li",{children:Object(N.jsx)("button",{children:"Crop"})}),Object(N.jsx)("li",{children:Object(N.jsx)("button",{children:"Time"})})]})})]}),Object(N.jsxs)("div",{className:"captured-footer",children:[Object(N.jsx)("div",{className:"footer-left",children:Object(N.jsx)("ul",{children:Object(N.jsx)("li",{children:Object(N.jsx)("button",{children:"Save"})})})}),Object(N.jsx)("div",{className:"footer-right",children:Object(N.jsx)("ul",{children:Object(N.jsx)("li",{children:Object(N.jsx)("button",{className:"capture",onClick:function(){f("send_to"),a([])},children:"Send to"})})})})]})]})]}):null,"send_to"===O&&d?Object(N.jsxs)(N.Fragment,{children:[M?null:Object(N.jsxs)("div",{className:"send_to-overlay",children:[Object(N.jsx)("div",{className:"send_to-header",children:Object(N.jsxs)("ul",{children:[Object(N.jsx)("li",{children:Object(N.jsx)("button",{onClick:function(){f("captured")},children:"Go Back"})}),Object(N.jsx)("li",{children:Object(N.jsx)("a",{children:"Search"})}),Object(N.jsx)("li",{children:Object(N.jsx)("a",{onClick:function(){e.get_friends_list(),P(!0)},children:"Add Friend"})})]})}),Object(N.jsxs)("div",{className:"send-list",children:[Object(N.jsx)("div",{className:"stories-header",children:Object(N.jsx)("h3",{children:"Recents"})}),Object(N.jsx)("ul",{className:"add-list list-container",children:e.user_friends_dict.map((function(s){return Object(N.jsx)(w,{send_list:n,handle_send_list:I,friend_pic:s.photoURL,friend_name:s.name,friend_username:s.email,friends_list:e.friends_list,user_email:e.user_email,get_friends_list:e.get_friends_list})}))})]}),n.length<=0?null:Object(N.jsxs)("div",{className:"send_to-footer",children:[Object(N.jsx)("div",{}),Object(N.jsx)("button",{className:"send",onClick:function(){o(null),f("camera");var s=b.a.auth().currentUser,t=Object(G.a)(),i=s.email,c=s.displayName,r="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7e/Circle-icons-profile.svg/2048px-Circle-icons-profile.svg.png",l=n;x.ref("posts/".concat(t)).putString(d,"data_url").on("state_changed",(function(e){}),(function(e){console.log(e)}),(function(){x.ref("posts").child(t).getDownloadURL().then((function(s){var n=b.a.firestore.FieldValue.serverTimestamp();l.forEach((function(e){g.collection("posts").doc(e).collection("Received").doc(i).collection("images").doc(t).set({imageURL:s,id:t,email:i,name:c,photoURL:r,timeStamp:n})})),l.forEach((function(e){g.collection("posts").doc(e).collection("Latest_Messages").doc(i).update({imageURL:s,photoURL:r,id:t,email:i,name:c,timeStamp:n,status:"New Snap"})})),g.collection("posts").doc(i).collection("Sent").doc(t).set({id:t,email:i,timeStamp:n,to:l}),l.forEach((function(e){e!=i&&g.collection("posts").doc(i).collection("Latest_Messages").doc(e).update({imageURL:s,photoURL:r,id:t,timeStamp:n,status:"Sent"})})),e.get_messages_list()}))})),console.log("Photo Sent"),a([])},children:Object(N.jsx)("h1",{children:"Send"})})]})]}),M&&null!=e.user_strangers_dict&&null!=e.user_friends_dict&&null!=e.everyone_dict?Object(N.jsxs)("div",{className:"add-friends",children:[Object(N.jsxs)("div",{className:"add-navbar",children:[Object(N.jsx)("div",{className:"nav-box-1",children:Object(N.jsx)("ul",{children:Object(N.jsx)("li",{children:Object(N.jsx)("a",{onClick:function(){e.get_friends_list(),P(!1)},children:Object(N.jsx)("b",{children:"Close"})})})})}),Object(N.jsx)("div",{className:"nav-box-2",children:Object(N.jsx)("h1",{children:"Add Friends"})}),Object(N.jsx)("div",{className:"nav-box-3",children:Object(N.jsx)("ul",{children:Object(N.jsx)("li",{children:Object(N.jsx)("a",{children:Object(N.jsx)("b",{children:". . ."})})})})})]}),Object(N.jsxs)("div",{className:"add-body",children:[Object(N.jsx)("div",{className:"search-bar",children:Object(N.jsx)("input",{type:"search",placeholder:"Find Friends"})}),Object(N.jsx)("div",{className:"add-title-navbar",children:Object(N.jsxs)("h3",{className:"quick-add",children:["Quick Add (",e.user_strangers_dict.length,")"]})}),Object(N.jsx)("ul",{className:"add-list list-container",children:e.user_strangers_dict.map((function(s){return Object(N.jsx)(S,{stranger_pic:s.photoURL,stranger_name:s.name,stranger_username:s.email,friend_username:s.email,friends_list:e.friends_list,user_email:e.user_email,get_friends_list:e.get_friends_list})}))}),Object(N.jsx)("div",{className:"add-title-navbar",children:Object(N.jsxs)("h3",{className:"quick-add",children:["Friends (",e.user_friends_dict.length,")"]})}),Object(N.jsx)("ul",{className:"add-list list-container",children:e.user_friends_dict.map((function(s){return Object(N.jsx)(k,{friend_pic:s.photoURL,friend_name:s.name,friend_username:s.email,friends_list:e.friends_list,user_email:e.user_email,get_friends_list:e.get_friends_list})}))}),Object(N.jsx)("div",{className:"add-title-navbar",children:Object(N.jsxs)("h3",{className:"quick-add",children:["Everyone (",e.everyone_dict.length,")"]})}),Object(N.jsx)("ul",{className:"add-list list-container",children:e.everyone_dict.map((function(e){return Object(N.jsx)(y,{stranger_pic:e.photoURL,stranger_name:e.name,stranger_username:e.email})}))}),Object(N.jsx)("div",{className:"add-footer"})]})]}):null]}):null]})})}t(213);var P=Object(h.bindKeyboard)(_.a),q="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7e/Circle-icons-profile.svg/2048px-Circle-icons-profile.svg.png",I={email:"Guest@project-yellow-ghost.com",name:"Guest",photoURL:q,streak_emoji:"\ud83d\udd25",imgs_sent:0,imgs_received:0,friends:["Guest@project-yellow-ghost.com"]},T=function(e){Object(o.a)(t,e);var s=Object(j.a)(t);function t(e){var i;return Object(r.a)(this,t),(i=s.call(this,e)).set_device=function(){i.state.width<i.state.height?i.setState({mobile:!0}):i.setState({mobile:!1})},i.update=function(){i.setState({width:window.innerWidth,height:window.innerHeight},i.set_device())},i.login=function(){O.signInWithPopup(f).then((function(e){i.setState({logged_in:!0,user_name:e.user.displayName,user_email:e.user.email,user_pic:e.user.photoURL,user_friends:[e.user.email]},i.get_friends_list)})).catch((function(e){return console.log(e.message)}))},i.logout=function(){b.a.auth().signOut(),i.setState({logged_in:!1,streak_emoji:"\ud83d\udd25",user_name:"Guest",user_email:"Guest",user_friends_dict:[I],user_strangers_dict:[I],everyone_dict:[I],user_pic:"https://upload.wikimedia.org/wikipedia/commons/thumb/7/7e/Circle-icons-profile.svg/2048px-Circle-icons-profile.svg.png"})},i.check_user=function(){b.a.auth().onAuthStateChanged(function(e){e&&this.setState({user_name:e.displayName,user_email:e.email,user_pic:e.photoURL,logged_in:!0},this.get_friends_list)}.bind(Object(d.a)(i)))},i.get_friends_list=function(){"Guest@project-yellow-ghost.com"!=i.state.user_email&&g.collection("users").doc(i.state.user_email).get().then((function(e){e.exists?i.setState({imgs_sent:e.data().imgs_sent,imgs_received:e.data().imgs_received,streak_emoji:e.data().streak_emoji},i.get_messages_list):(g.collection("users").doc(i.state.user_email).set({email:i.state.user_email,name:i.state.user_name,photoURL:i.state.user_pic,streak_emoji:i.state.streak_emoji,imgs_sent:0,imgs_received:0,friends:[i.state.user_email]}).catch((function(e){console.log("Couldn't write user to DB, error: ",e)})),g.collection("posts").doc(i.state.user_email).collection("Latest_Messages").doc(i.state.user_email).set({email:i.state.user_email,name:i.state.user_name,imageURL:null,photoURL:i.state.user_pic,imgs_sent:0,imgs_received:0,friend_since:b.a.firestore.FieldValue.serverTimestamp(),status:"New Friend!",streak_num:0,timeStamp:null,id:null}).catch((function(e){console.log("Couldn't write user to DB, error: ",e)})),i.get_messages_list())})).catch((function(e){console.log("Error getting document:",e)}))},i.get_messages_list=function(){var e=[];g.collection("posts").doc(i.state.user_email).collection("Latest_Messages").get().then((function(s){s.forEach((function(s){e.push(s.data().email)}))})),i.setState({user_friends:e},i.get_all_users)},i.get_all_users=function(){var e=[],s=[],t=[];g.collection("users").get().then((function(c){for(var n=0;n<c.docs.length;n++)i.state.user_friends.includes(c.docs[n].data().email)?e.push(c.docs[n].data()):s.push(c.docs[n].data()),t.push(c.docs[n].data());i.setState({user_friends_dict:e,user_strangers_dict:s,everyone_dict:t})}))},i.state={index:0,height:window.innerHeight,width:window.innerWidth,mobile:!1,logged_in:!1,user_friends_dict:[I],user_strangers_dict:[I],everyone_dict:[I],user_email:"Guest@project-yellow-ghost.com",user_name:"Guest",user_pic:q,streak_emoji:"\ud83d\udd25",imgs_sent:0,imgs_received:0,user_friends:["Guest@project-yellow-ghost.com"]},window.addEventListener("resize",i.update),i}return Object(l.a)(t,[{key:"componentDidMount",value:function(){this.check_user(),this.set_device()}},{key:"render",value:function(){return Object(N.jsxs)(P,{enableMouseEvents:!0,style:Object.assign({width:this.state.width,height:this.state.height,position:"absolute",top:"0%",left:"0%"}),children:[Object(N.jsxs)("div",{style:Object.assign({backgroundColor:"white",minHeight:"100vh",width:"100%"}),children:[Object(N.jsx)(u.a,{children:Object(N.jsx)("meta",{name:"viewport",content:"height=device-height, width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"})}),Object(N.jsx)(U,{user_email:this.state.user_email,user_name:this.state.user_name,user_pic:this.state.user_pic,user_friends_dict:this.state.user_friends_dict,user_strangers_dict:this.state.user_strangers_dict,everyone_dict:this.state.everyone_dict,logged_in:this.state.logged_in,login:this.login.bind(this),logout:this.logout.bind(this),get_friends_list:this.get_friends_list.bind(this),get_messages_list:this.get_messages_list.bind(this),get_all_users:this.get_all_users.bind(this),friends_list:this.state.user_friends,streak_emoji:this.state.streak_emoji})]}),Object(N.jsx)("div",{style:Object.assign({backgroundColor:"Plum"}),children:Object(N.jsx)(M,{height:this.state.height,width:this.state.width,mobile:this.state.mobile,user_email:this.state.user_email,user_name:this.state.user_name,user_pic:this.state.user_pic,user_friends_dict:this.state.user_friends_dict,user_strangers_dict:this.state.user_strangers_dict,everyone_dict:this.state.everyone_dict,logged_in:this.state.logged_in,login:this.login.bind(this),logout:this.logout.bind(this),get_friends_list:this.get_friends_list.bind(this),get_messages_list:this.get_messages_list.bind(this),get_all_users:this.get_all_users.bind(this),friends_list:this.state.user_friends})})]})}}]),t}(c.a.Component);a.a.render(Object(N.jsx)(T,{}),document.getElementById("root"))}},[[508,1,2]]]);
//# sourceMappingURL=main.e414bbc1.chunk.js.map