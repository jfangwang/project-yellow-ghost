(this["webpackJsonpproject-yellow-ghost"]=this["webpackJsonpproject-yellow-ghost"]||[]).push([[0],{108:function(e,s,t){},211:function(e,s,t){},45:function(e,s,t){},508:function(e,s,t){"use strict";t.r(s);var i=t(5),c=t.n(i),n=t(28),a=t.n(n),r=t(152),l=t(153),o=t(67),d=t(164),u=t(163),j=t(154),m=t(157),h=t.n(m),b=t(158),_=t(18),g=(t(207),t(510),t(209),t(511),t(509),t(512),_.a.initializeApp({apiKey:"AIzaSyAzNigqy7stltnVUU8cAollxCxvW0CNBTE",authDomain:"ghost-f8b34.firebaseapp.com",projectId:"ghost-f8b34",storageBucket:"ghost-f8b34.appspot.com",messagingSenderId:"838623299070",appId:"1:838623299070:web:b73429fee525b7c01cacaf",measurementId:"G-85ZG5FVKQ4"}).firestore()),O=_.a.auth(),f=_.a.storage(),x=new _.a.auth.GoogleAuthProvider,p=(t(211),t(45),t(10)),v=t(2);function N(e){var s=Object(i.useState)(!1),t=Object(p.a)(s,2),c=t[0],n=t[1],a=g.collection("users").doc(e.user_email);return Object(v.jsxs)("li",{className:"add-friends-content",children:[Object(v.jsxs)("div",{className:"add-box-1",children:[Object(v.jsx)("img",{className:"message-avatar",src:e.friend_pic,alt:"Avatar"}),Object(v.jsxs)("ul",{className:"message-info",children:[Object(v.jsx)("h3",{children:e.friend_name}),Object(v.jsx)("p",{children:e.friend_username})]})]}),Object(v.jsx)("div",{className:"add-box-2",children:c?Object(v.jsx)("p",{className:"removed",children:Object(v.jsx)("b",{children:"Removed!"})}):Object(v.jsx)("button",{onClick:function(){"Guest@project-yellow-ghost.com"!=e.friend_username&&(e.friends_list.splice(e.friends_list.indexOf(e.friend_username),1),a.update({friends:e.friends_list})),n(!0)},children:Object(v.jsx)("b",{children:"Remove"})})})]})}function w(e){var s=Object(i.useState)(!1),t=Object(p.a)(s,2),c=t[0],n=t[1],a=g.collection("users").doc(e.user_email);return Object(v.jsxs)("li",{className:"add-friends-content",children:[Object(v.jsxs)("div",{className:"add-box-1",children:[Object(v.jsx)("img",{className:"message-avatar",src:e.stranger_pic,alt:"Avatar"}),Object(v.jsxs)("ul",{className:"message-info",children:[Object(v.jsx)("h3",{children:e.stranger_name}),Object(v.jsx)("p",{children:e.stranger_username})]})]}),Object(v.jsx)("div",{className:"add-box-2",children:c?Object(v.jsx)("p",{className:"added",children:Object(v.jsx)("b",{children:"Added!"})}):Object(v.jsx)("button",{onClick:function(){"Guest@project-yellow-ghost.com"!=e.friend_username&&(e.friends_list.push(e.stranger_username),a.update({friends:e.friends_list})),n(!0)},children:Object(v.jsx)("b",{children:"Add"})})})]})}function y(e){return Object(v.jsxs)("li",{className:"add-friends-content",children:[Object(v.jsxs)("div",{className:"add-box-1",children:[Object(v.jsx)("img",{className:"message-avatar",src:e.stranger_pic,alt:"Avatar"}),Object(v.jsxs)("ul",{className:"message-info",children:[Object(v.jsx)("h3",{children:e.stranger_name}),Object(v.jsx)("p",{children:e.stranger_username})]})]}),Object(v.jsx)("div",{className:"add-box-2"})]})}function S(e){var s=Object(i.useState)(!1),t=Object(p.a)(s,2),c=t[0],n=t[1];return Object(v.jsxs)(v.Fragment,{children:[c?null:Object(v.jsxs)("div",{className:"navbar",children:[Object(v.jsx)("div",{className:"nav-box-1",children:Object(v.jsxs)("ul",{children:[Object(v.jsx)("li",{children:"Guest"==e.user_name?Object(v.jsx)("a",{onClick:e.login,children:"Sign In"}):Object(v.jsx)("img",{className:"profile-pic",src:e.user_pic,onClick:e.logout,alt:"Profile Picture"})}),Object(v.jsx)("li",{children:Object(v.jsx)("a",{children:"Search"})})]})}),Object(v.jsx)("div",{className:"nav-box-2",children:Object(v.jsx)("h1",{children:"Chat"})}),Object(v.jsx)("div",{className:"nav-box-3",children:Object(v.jsxs)("ul",{children:[Object(v.jsx)("li",{children:Object(v.jsx)("a",{onClick:function(){e.get_friends_list(),n(!0)},children:"Add Friend"})}),Object(v.jsx)("li",{children:Object(v.jsx)("a",{children:"New Chat"})})]})})]}),c&&null!=e.user_strangers_dict&&null!=e.user_friends_dict&&null!=e.everyone_dict?Object(v.jsxs)("div",{className:"add-friends",children:[Object(v.jsxs)("div",{className:"add-navbar",children:[Object(v.jsx)("div",{className:"nav-box-1",children:Object(v.jsx)("ul",{children:Object(v.jsx)("li",{children:Object(v.jsx)("a",{onClick:function(){e.get_friends_list(),n(!1)},children:Object(v.jsx)("b",{children:"Close"})})})})}),Object(v.jsx)("div",{className:"nav-box-2",children:Object(v.jsx)("h1",{children:"Add Friends"})}),Object(v.jsx)("div",{className:"nav-box-3",children:Object(v.jsx)("ul",{children:Object(v.jsx)("li",{children:Object(v.jsx)("a",{children:Object(v.jsx)("b",{children:". . ."})})})})})]}),Object(v.jsxs)("div",{className:"add-body",children:[Object(v.jsx)("div",{className:"search-bar",children:Object(v.jsx)("input",{type:"search",placeholder:"Find Friends"})}),Object(v.jsx)("div",{className:"add-title-navbar",children:Object(v.jsxs)("h3",{className:"quick-add",children:["Quick Add (",e.user_strangers_dict.length,")"]})}),Object(v.jsx)("ul",{className:"add-list list-container",children:e.user_strangers_dict.map((function(s){return Object(v.jsx)(w,{stranger_pic:s.photoURL,stranger_name:s.name,stranger_username:s.email,friend_username:s.email,friends_list:e.friends_list,user_email:e.user_email,get_friends_list:e.get_friends_list})}))}),Object(v.jsx)("div",{className:"add-title-navbar",children:Object(v.jsxs)("h3",{className:"quick-add",children:["Friends (",e.user_friends_dict.length,")"]})}),Object(v.jsx)("ul",{className:"add-list list-container",children:e.user_friends_dict.map((function(s){return Object(v.jsx)(N,{friend_pic:s.photoURL,friend_name:s.name,friend_username:s.email,friends_list:e.friends_list,user_email:e.user_email,get_friends_list:e.get_friends_list})}))}),Object(v.jsx)("div",{className:"add-title-navbar",children:Object(v.jsxs)("h3",{className:"quick-add",children:["Everyone (",e.everyone_dict.length,")"]})}),Object(v.jsx)("ul",{className:"add-list list-container",children:e.everyone_dict.map((function(e){return Object(v.jsx)(y,{stranger_pic:e.photoURL,stranger_name:e.name,stranger_username:e.email})}))}),Object(v.jsx)("div",{className:"add-footer"})]})]}):null]})}var k=t(162);function C(e){var s=Object(i.useState)("Received"),t=Object(p.a)(s,2),c=t[0],n=t[1],a=Object(i.useState)(0),r=Object(p.a)(a,2),l=r[0],o=r[1],d=Object(i.useState)([]),u=Object(p.a)(d,2),j=(u[0],u[1],function(){g.collection("posts").doc(e.user_email).collection("Received").orderBy("timeStamp","desc").onSnapshot((function(s){for(var t=0;t<s.docs.length&&s.docs[t].data().email!=e.sender_email;)t+=1;t<s.docs.length&&s.docs[t].data().email==e.sender_email?(n("New Snap"),null!=s.docs[t].data().timeStamp&&o(s.docs[t].data().timeStamp.toDate().toUTCString())):n("Received")}))}),m=Object(v.jsx)("p",{children:c}),h=Object(v.jsx)("div",{className:"message-received"});"New Snap"===c?(h=Object(v.jsx)("div",{className:"message-new"}),m=Object(v.jsx)("p",{className:"red",children:Object(v.jsx)("b",{children:c})})):"Received"===c?h=Object(v.jsx)("div",{className:"message-received"}):"Sent"===c?h=Object(v.jsx)("div",{className:"message-sent"}):"Opened"===c&&(h=Object(v.jsx)("div",{className:"message-opened"}));var b=Object(i.useState)(null),_=Object(p.a)(b,2),O=_[0],x=_[1],N=Object(i.useState)(null),w=Object(p.a)(N,2),y=w[0],S=w[1];return Object(i.useEffect)((function(){j()})),Object(v.jsx)(v.Fragment,{children:O?Object(v.jsx)("div",{className:"image-background",onClick:function(){x(null),g.collection("posts").doc(e.user_email).collection("Received").doc(y).delete().then((function(){console.log("Document deleted")})).catch((function(e){console.log("Error removing document: ",e)})),j();var s=g.collection("posts").doc(e.sender_email).collection("Sent").doc(y);s.get().then((function(t){if(1==t.data().to.length)s.delete().then((function(){console.log("sender document deleted, everyone saw the pic")})).catch((function(e){console.log("Could not delete sender's document")})),f.ref("posts/".concat(y)).delete().then((function(e){console.log("Deleted from storage: ",y)})).catch((function(e){console.log("TRIED DELETING: ",y)})),g.collection("posts").doc(y).delete().then((function(){console.log("Deleted from firestore")})).catch((function(e){console.error("Error removing document: ",e)}));else{var i=0,c=[];for(i=0;i<t.data().to.length;i+=1)t.data().to[i]!=e.user_email&&(c[i]=t.data().to[i]);s.update({to:c}).then((function(){console.log("Updated sender's list")})).catch((function(e){console.log("could not update list: ",e)}))}}))},children:Object(v.jsx)("img",{id:"image",className:"",src:O})}):Object(v.jsxs)("li",{className:"message-content",onClick:function(){console.log("opening snap",e.user_email),g.collection("posts").doc(e.user_email).collection("Received").orderBy("timeStamp","desc").get().then((function(s){for(var t=0;t<s.docs.length&&s.docs[t].data().email!=e.sender_email;)t+=1;t<s.docs.length&&s.docs[t].data().email==e.sender_email?null!=s.docs[t].data()&&(x(s.docs[t].data().imageURL),S(s.docs[t].data().id)):n("Received")}))},children:[Object(v.jsx)("img",{className:"message-avatar",src:e.profile_url,alt:"Avatar"}),Object(v.jsxs)("ul",{className:"message-info",children:[Object(v.jsx)("h3",{children:e.sender_name}),Object(v.jsxs)("div",{className:"message-sub-info",children:[h,m,0!=l?Object(v.jsx)("p",{children:Object(v.jsx)(k.a,{date:l,locale:"en-US"})}):null,e.streak_num>0?Object(v.jsxs)("p",{children:[e.streak_num,e.streak_emoji]}):null]})]})]})})}var R=function(e){return Object(v.jsxs)("div",{className:"messages-screen",children:[Object(v.jsx)(S,{user_email:e.user_email,user_name:e.user_name,user_pic:e.user_pic,login:e.login,logout:e.logout,user_friends_dict:e.user_friends_dict,user_strangers_dict:e.user_strangers_dict,everyone_dict:e.everyone_dict,get_friends_list:e.get_friends_list,get_all_users:e.get_all_users,friends_list:e.friends_list,logged_in:e.logged_in}),Object(v.jsxs)("ul",{className:"messages-list",children:[e.logged_in?null:Object(v.jsx)("li",{className:"welcome-statement",children:"Welcome to Project Yellow Ghost, a web app version of SnapChat. This was a project developed by Jonathan Wang and this was his final project for school. Right now, you are on a local guest account for you to try out. Feel free to sign in at the top if you want to start using this product. Happy Snapping!"}),e.user_friends_dict.map((function(s){return Object(v.jsx)(C,{sender_email:s.email,profile_url:s.photoURL,sender_name:s.name,user_email:e.user_email,streak_emoji:e.streak_emoji,logged_in:e.logged_in})}))]})]})},E=t(159),A=t.n(E),L=t(515);t(108);function G(e){return Object(v.jsxs)("div",{className:"webcam-navbar",children:[Object(v.jsx)("div",{className:"nav-box-1 webcam-nav-box",children:Object(v.jsxs)("ul",{children:[Object(v.jsx)("li",{children:"Guest"==e.user_name?Object(v.jsx)("a",{onClick:e.login,children:"Sign In"}):Object(v.jsx)("img",{className:"profile-pic",src:e.user_pic,onClick:e.logout,alt:"Profile Picture"})}),Object(v.jsx)("li",{children:Object(v.jsx)("a",{children:"Search"})})]})}),Object(v.jsx)("div",{className:"nav-box-3 webcam-nav-box",children:Object(v.jsxs)("ul",{children:[Object(v.jsx)("li",{children:Object(v.jsx)("a",{children:"Add Friend"})}),Object(v.jsx)("li",{children:Object(v.jsx)("a",{children:"Flip Camera"})})]})})]})}function U(e){var s=Object(i.useState)(null),t=Object(p.a)(s,2),n=t[0],a=t[1],r=Object(i.useState)("user"),l=Object(p.a)(r,2),o=l[0],d=(l[1],Object(i.useState)("camera")),u=Object(p.a)(d,2),j=u[0],m=u[1],h=c.a.useRef(null),b=Object(i.useState)(16/9),O=Object(p.a)(b,2),x=O[0],N=O[1],w=function(){a(null),m("camera")},y=c.a.useCallback((function(){var e=h.current.getScreenshot();a(e),m("captured")}),[h]);return Object(i.useEffect)((function(){try{e.mobile?(document.querySelector("#imageElement").classList.add("image-mobile"),document.querySelector("#imageElement").classList.remove("image-desktop"),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?N(16/9):N(9/16)):(document.querySelector("#imageElement").classList.add("image-desktop"),document.querySelector("#imageElement").classList.remove("image-mobile"),N(16/9),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?N(9/16):N(16/9)),console.log(document.querySelector("#imageElement").classList)}catch(s){}})),Object(v.jsxs)(v.Fragment,{children:["camera"===j?Object(v.jsxs)("div",{className:"webcam-screen",children:[Object(v.jsx)(A.a,{id:"imageElement",className:"image-mobile",ref:h,audio:!1,mirrored:!0,forceScreenshotSourceSize:!1,screenshotFormat:"image/png",screenshotQuality:1,videoConstraints:{facingMode:o,aspectRatio:x}}),Object(v.jsxs)("div",{className:"webcam-overlay",children:[Object(v.jsx)(G,{user_email:e.user_email,user_name:e.user_name,user_pic:e.user_pic,login:e.login,logout:e.logout,user_friends_dict:e.user_friends_dict,user_strangers_dict:e.user_strangers_dict,everyone_dict:e.everyone_dict,get_friends_list:e.get_friends_list,get_all_users:e.get_all_users,friends_list:e.friends_list,logged_in:e.logged_in}),Object(v.jsx)("div",{className:"webcam-footer",children:Object(v.jsx)("ul",{})}),Object(v.jsx)("div",{className:"webcam-footer",children:Object(v.jsx)("div",{className:"nav-box-1",children:Object(v.jsxs)("ul",{children:[Object(v.jsx)("li",{children:Object(v.jsx)("a",{children:"Memories"})}),Object(v.jsx)("li",{children:Object(v.jsx)("a",{onClick:y,children:"Capture"})}),Object(v.jsx)("li",{children:Object(v.jsx)("a",{children:"Filters"})})]})})})]})]}):null,"captured"===j&&n?Object(v.jsxs)("div",{className:"webcam-overlay",children:[Object(v.jsx)("div",{className:"image-preview",children:Object(v.jsx)("img",{id:"imageElement",className:"",src:n})}),Object(v.jsx)("div",{className:"buttons-overlay",children:Object(v.jsxs)("div",{className:"webcam-footer",children:[Object(v.jsx)("button",{className:"capture",onClick:function(){m("send_to")},children:"Send to"}),Object(v.jsx)("button",{className:"send",onClick:w,children:"Close"})]})})]}):null,"send_to"===j&&n?Object(v.jsx)("div",{className:"webcam-overlay",children:Object(v.jsx)("div",{className:"buttons-overlay",children:Object(v.jsxs)("div",{className:"webcam-footer",children:[Object(v.jsx)("button",{className:"send",onClick:function(){var e=_.a.auth().currentUser,s=Object(L.a)(),t=e.email,i=e.displayName,c=[t];f.ref("posts/".concat(s)).putString(n,"data_url").on("state_changed",(function(e){}),(function(e){console.log(e)}),(function(){var e=0;for(e=0;e<c.length;e++){console.log(typeof c[e],c[e]);var n=c[e];f.ref("posts").child(s).getDownloadURL().then((function(e){g.collection("posts").doc(n).collection("Received").doc(s).set({imageURL:e,id:s,email:t,name:i,avatarURL:"https://upload.wikimedia.org/wikipedia/commons/thumb/7/7e/Circle-icons-profile.svg/2048px-Circle-icons-profile.svg.png",read:!1,timeStamp:_.a.firestore.FieldValue.serverTimestamp(),to:c}),console.log("Photo Sent"),a(null),m("camera")}))}g.collection("posts").doc(t).collection("Sent").doc(s).set({id:s,email:t,timeStamp:_.a.firestore.FieldValue.serverTimestamp(),to:c})}))},children:"Send"}),Object(v.jsx)("button",{className:"capture",onClick:w,children:"Close"})]})})}):null]})}t(213);var F=Object(b.bindKeyboard)(h.a),P="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7e/Circle-icons-profile.svg/2048px-Circle-icons-profile.svg.png",I={email:"Guest@project-yellow-ghost.com",name:"Guest",photoURL:P,streak_emoji:"\ud83d\udd25",imgs_sent:0,imgs_received:0,friends:["Guest@project-yellow-ghost.com"]},B=function(e){Object(d.a)(t,e);var s=Object(u.a)(t);function t(e){var i;return Object(r.a)(this,t),(i=s.call(this,e)).set_device=function(){i.state.width<i.state.height?i.setState({mobile:!0}):i.setState({mobile:!1})},i.update=function(){i.setState({width:window.innerWidth,height:window.innerHeight},i.set_device())},i.login=function(){O.signInWithPopup(x).then((function(e){i.setState({logged_in:!0,user_name:e.user.displayName,user_email:e.user.email,user_pic:e.user.photoURL,user_friends:[e.user.email]},i.get_friends_list)})).catch((function(e){return console.log(e.message)}))},i.logout=function(){_.a.auth().signOut(),i.setState({logged_in:!1,streak_emoji:"\ud83d\udd25",user_name:"Guest",user_email:"Guest",user_friends_dict:[I],user_strangers_dict:[I],everyone_dict:[I],user_pic:"https://upload.wikimedia.org/wikipedia/commons/thumb/7/7e/Circle-icons-profile.svg/2048px-Circle-icons-profile.svg.png"})},i.check_user=function(){_.a.auth().onAuthStateChanged(function(e){e&&this.setState({user_name:e.displayName,user_email:e.email,user_pic:e.photoURL,logged_in:!0},this.get_friends_list)}.bind(Object(o.a)(i)))},i.get_friends_list=function(){"Guest"!=i.state.user_email&&g.collection("users").doc(i.state.user_email).get().then((function(e){e.exists?i.setState({user_friends:e.data().friends,imgs_sent:e.data().imgs_sent,imgs_received:e.data().imgs_received,streak_emoji:e.data().streak_emoji},i.get_all_users):(g.collection("users").doc(i.state.user_email).set({email:i.state.user_email,name:i.state.user_name,photoURL:i.state.user_pic,streak_emoji:i.state.streak_emoji,imgs_sent:0,imgs_received:0,friends:[i.state.user_email]}).catch((function(e){console.log("Couldn't write user to DB, error: ",e)})),i.get_all_users())})).catch((function(e){console.log("Error getting document:",e)}))},i.get_all_users=function(){var e=[],s=[],t=[],c=0,n=0,a=0;g.collection("users").get().then((function(r){for(var l=0;l<r.docs.length;l++)i.state.user_friends.includes(r.docs[l].data().email)?(e[c]=r.docs[l].data(),c+=1):(s[n]=r.docs[l].data(),n+=1),t[a]=r.docs[l].data(),a+=1;i.setState({user_friends_dict:e,user_strangers_dict:s,everyone_dict:t})}))},i.state={index:0,height:window.innerHeight,width:window.innerWidth,mobile:!1,logged_in:!1,user_friends_dict:[I],user_strangers_dict:[I],everyone_dict:[I],user_email:"Guest",user_name:"Guest",user_pic:P,streak_emoji:"\ud83d\udd25",imgs_sent:0,imgs_received:0,user_friends:["Guest@mail"]},window.addEventListener("resize",i.update),i}return Object(l.a)(t,[{key:"componentDidMount",value:function(){this.check_user(),this.set_device()}},{key:"render",value:function(){return Object(v.jsxs)(F,{enableMouseEvents:!0,style:Object.assign({width:this.state.width,height:this.state.height,position:"absolute",top:"0%",left:"0%"}),children:[Object(v.jsxs)("div",{style:Object.assign({backgroundColor:"white",minHeight:"100vh",width:"100%"}),children:[Object(v.jsx)(j.a,{children:Object(v.jsx)("meta",{name:"viewport",content:"height=device-height, width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"})}),Object(v.jsx)(R,{user_email:this.state.user_email,user_name:this.state.user_name,user_pic:this.state.user_pic,user_friends_dict:this.state.user_friends_dict,user_strangers_dict:this.state.user_strangers_dict,everyone_dict:this.state.everyone_dict,logged_in:this.state.logged_in,login:this.login.bind(this),logout:this.logout.bind(this),get_friends_list:this.get_friends_list.bind(this),get_all_users:this.get_all_users.bind(this),friends_list:this.state.user_friends,streak_emoji:this.state.streak_emoji})]}),Object(v.jsx)("div",{style:Object.assign({backgroundColor:"Plum"}),children:Object(v.jsx)(U,{height:this.state.height,width:this.state.width,user_name:this.state.user_name,user_pic:this.state.user_pic,login:this.login.bind(this),logout:this.logout.bind(this),mobile:this.state.mobile})})]})}}]),t}(c.a.Component);a.a.render(Object(v.jsx)(B,{}),document.getElementById("root"))}},[[508,1,2]]]);
//# sourceMappingURL=main.6d39dea0.chunk.js.map