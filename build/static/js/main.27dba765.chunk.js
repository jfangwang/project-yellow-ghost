(this["webpackJsonpproject-yellow-ghost"]=this["webpackJsonpproject-yellow-ghost"]||[]).push([[0],{100:function(e,t,s){"use strict";s.r(t);var n=s(4),i=s.n(n),a=s(44),c=s.n(a),r=s(13),l=s(14),o=s(17),d=s(16),u=s(38),j=s(26),m=s.n(j),h=s(27),g=(s(92),s(25)),b=s(10),f=(s(93),s(103),s(95),s(102),s(101),s(104),b.a.initializeApp({apiKey:"AIzaSyAzNigqy7stltnVUU8cAollxCxvW0CNBTE",authDomain:"ghost-f8b34.firebaseapp.com",projectId:"ghost-f8b34",storageBucket:"ghost-f8b34.appspot.com",messagingSenderId:"838623299070",appId:"1:838623299070:web:b73429fee525b7c01cacaf",measurementId:"G-85ZG5FVKQ4"}).firestore()),p=b.a.auth(),O=b.a.storage(),_=new b.a.auth.GoogleAuthProvider,x=(s(24),s(11)),v=s(2);function N(e){var t=Object(n.useState)(!1),s=Object(x.a)(t,2),i=s[0],a=s[1],c=f.collection("users").doc(e.user_email);return Object(v.jsxs)("li",{className:"add-friends-content",children:[Object(v.jsxs)("div",{className:"add-box-1",children:[Object(v.jsx)("img",{className:"message-avatar",src:e.friend_pic,alt:"Avatar"}),Object(v.jsxs)("ul",{className:"message-info",children:[Object(v.jsx)("h3",{children:e.friend_name}),Object(v.jsx)("p",{children:e.friend_username})]})]}),Object(v.jsx)("div",{className:"add-box-2",children:i?Object(v.jsx)("p",{className:"removed",children:Object(v.jsx)("b",{children:"Removed!"})}):Object(v.jsx)("button",{onClick:function(){e.friends_list.splice(e.friends_list.indexOf(e.friend_username),1),c.update({friends:e.friends_list}),a(!0)},children:Object(v.jsx)("b",{children:"Remove"})})})]})}function w(e){var t=Object(n.useState)(!1),s=Object(x.a)(t,2),i=s[0],a=s[1],c=f.collection("users").doc(e.user_email);return Object(v.jsxs)("li",{className:"add-friends-content",children:[Object(v.jsxs)("div",{className:"add-box-1",children:[Object(v.jsx)("img",{className:"message-avatar",src:e.stranger_pic,alt:"Avatar"}),Object(v.jsxs)("ul",{className:"message-info",children:[Object(v.jsx)("h3",{children:e.stranger_name}),Object(v.jsx)("p",{children:e.stranger_username})]})]}),Object(v.jsx)("div",{className:"add-box-2",children:i?Object(v.jsx)("p",{className:"added",children:Object(v.jsx)("b",{children:"Added!"})}):Object(v.jsx)("button",{onClick:function(){e.friends_list.push(e.stranger_username),c.update({friends:e.friends_list}),a(!0)},children:Object(v.jsx)("b",{children:"Add"})})})]})}function k(e){return Object(v.jsxs)("li",{className:"add-friends-content",children:[Object(v.jsxs)("div",{className:"add-box-1",children:[Object(v.jsx)("img",{className:"message-avatar",src:e.stranger_pic,alt:"Avatar"}),Object(v.jsxs)("ul",{className:"message-info",children:[Object(v.jsx)("h3",{children:e.stranger_name}),Object(v.jsx)("p",{children:e.stranger_username})]})]}),Object(v.jsx)("div",{className:"add-box-2"})]})}function S(e){var t=Object(n.useState)(!1),s=Object(x.a)(t,2),i=s[0],a=s[1];return Object(v.jsxs)(v.Fragment,{children:[i?null:Object(v.jsxs)("div",{className:"navbar",children:[Object(v.jsx)("div",{className:"nav-box-1",children:Object(v.jsxs)("ul",{children:[Object(v.jsx)("li",{children:"Guest"==e.user_name?Object(v.jsx)("a",{onClick:e.login,children:"Sign In"}):Object(v.jsx)("img",{className:"profile-pic",src:e.user_pic,onClick:e.logout,alt:"Profile Picture"})}),Object(v.jsx)("li",{children:Object(v.jsx)("a",{children:"Search"})})]})}),Object(v.jsx)("div",{className:"nav-box-2",children:Object(v.jsx)("h1",{children:"Chat"})}),Object(v.jsx)("div",{className:"nav-box-3",children:Object(v.jsxs)("ul",{children:[Object(v.jsx)("li",{children:Object(v.jsx)("a",{onClick:function(){a(!0),e.get_friends_list()},children:"Add Friend"})}),Object(v.jsx)("li",{children:Object(v.jsx)("a",{children:"New Chat"})})]})})]}),i?Object(v.jsxs)("div",{className:"add-friends",children:[Object(v.jsxs)("div",{className:"add-navbar",children:[Object(v.jsx)("div",{className:"nav-box-1",children:Object(v.jsx)("ul",{children:Object(v.jsx)("li",{children:Object(v.jsx)("a",{onClick:function(){a(!1),e.get_friends_list()},children:Object(v.jsx)("b",{children:"Close"})})})})}),Object(v.jsx)("div",{className:"nav-box-2",children:Object(v.jsx)("h1",{children:"Add Friends"})}),Object(v.jsx)("div",{className:"nav-box-3",children:Object(v.jsx)("ul",{children:Object(v.jsx)("li",{children:Object(v.jsx)("a",{children:Object(v.jsx)("b",{children:". . ."})})})})})]}),Object(v.jsxs)("div",{className:"add-body",children:[Object(v.jsx)("div",{className:"search-bar",children:Object(v.jsx)("input",{type:"search",placeholder:"Find Friends"})}),Object(v.jsx)("div",{className:"add-title-navbar",children:Object(v.jsxs)("h3",{className:"quick-add",children:["Quick Add (",e.logged_in?e.user_strangers.length:0,")"]})}),Object(v.jsx)("ul",{className:"add-list list-container",children:e.logged_in?e.user_strangers.map((function(t){return Object(v.jsx)(w,{stranger_pic:t.photoURL,stranger_name:t.name,stranger_username:t.email,friends_list:e.friends_list,user_email:e.user_email,get_friends_list:e.get_friends_list})})):null}),Object(v.jsx)("div",{className:"add-title-navbar",children:Object(v.jsxs)("h3",{className:"quick-add",children:["Friends (",e.user_friends.length,")"]})}),Object(v.jsx)("ul",{className:"add-list list-container",children:e.user_friends.map((function(t){return Object(v.jsx)(N,{friend_pic:t.photoURL,friend_name:t.name,friend_username:t.email,friends_list:e.friends_list,user_email:e.user_email,get_friends_list:e.get_friends_list})}))}),Object(v.jsx)("div",{className:"add-title-navbar",children:Object(v.jsxs)("h3",{className:"quick-add",children:["Everyone (",e.everyone.length,")"]})}),Object(v.jsx)("ul",{className:"add-list list-container",children:e.everyone.map((function(e){return Object(v.jsx)(k,{stranger_pic:e.photoURL,stranger_name:e.name,stranger_username:e.email})}))}),Object(v.jsx)("div",{className:"add-footer"})]})]}):null]})}var y=s(48);function C(e){var t=Object(n.useState)("Received"),s=Object(x.a)(t,2),i=s[0],a=s[1],c=Object(n.useState)(0),r=Object(x.a)(c,2),l=r[0],o=r[1],d=Object(n.useState)([]),u=Object(x.a)(d,2),j=(u[0],u[1],function(){f.collection("posts").doc(e.user_email).collection("Received").orderBy("timeStamp","desc").onSnapshot((function(t){for(var s=0;s<t.docs.length&&t.docs[s].data().email!=e.sender_email;)s+=1;s<t.docs.length&&t.docs[s].data().email==e.sender_email?(a("New Snap"),null!=t.docs[s].data().timeStamp&&o(t.docs[s].data().timeStamp.toDate().toUTCString())):a("Received")}))}),m=Object(v.jsx)("p",{children:i}),h=Object(v.jsx)("div",{className:"message-received"});"New Snap"===i?(h=Object(v.jsx)("div",{className:"message-new"}),m=Object(v.jsx)("p",{className:"red",children:Object(v.jsx)("b",{children:i})})):"Received"===i?h=Object(v.jsx)("div",{className:"message-received"}):"Sent"===i?h=Object(v.jsx)("div",{className:"message-sent"}):"Opened"===i&&(h=Object(v.jsx)("div",{className:"message-opened"}));var g=Object(n.useState)(null),b=Object(x.a)(g,2),p=b[0],_=b[1],N=Object(n.useState)(null),w=Object(x.a)(N,2),k=w[0],S=w[1];return Object(n.useEffect)((function(){j()})),Object(v.jsx)(v.Fragment,{children:p?Object(v.jsx)("div",{className:"image-background",onClick:function(){_(null),console.log("opening snap",e.user_email),f.collection("posts").doc(e.user_email).collection("Received").doc(k).delete().then((function(){console.log("Document deleted")})).catch((function(e){console.log("Error removing document: ",e)})),j();var t=f.collection("posts").doc(e.sender_email).collection("Sent").doc(k);t.get().then((function(s){if(1==s.data().to.length)t.delete().then((function(){console.log("sender document deleted, everyone saw the pic")})).catch((function(e){console.log("Could not delete sender's document")})),O.ref("posts/".concat(k)).delete().then((function(e){console.log("Deleted from storage: ",k)})).catch((function(e){console.log("TRIED DELETING: ",k)})),f.collection("posts").doc(k).delete().then((function(){console.log("Deleted from firestore")})).catch((function(e){console.error("Error removing document: ",e)}));else{var n=0,i=[];for(n=0;n<s.data().to.length;n+=1)s.data().to[n]!=e.user_email&&(i[n]=s.data().to[n]);t.update({to:i}).then((function(){console.log("Updated sender's list")})).catch((function(e){console.log("could not update list: ",e)}))}}))},children:Object(v.jsx)("img",{className:"image",src:p})}):Object(v.jsxs)("li",{className:"message-content",onClick:function(){console.log("opening snap",e.user_email),f.collection("posts").doc(e.user_email).collection("Received").orderBy("timeStamp","desc").get().then((function(t){for(var s=0;s<t.docs.length&&t.docs[s].data().email!=e.sender_email;)s+=1;s<t.docs.length&&t.docs[s].data().email==e.sender_email?null!=t.docs[s].data()&&(_(t.docs[s].data().imageURL),S(t.docs[s].data().id)):a("Received")}))},children:[Object(v.jsx)("img",{className:"message-avatar",src:e.profile_url,alt:"Avatar"}),Object(v.jsxs)("ul",{className:"message-info",children:[Object(v.jsx)("h3",{children:e.sender_name}),Object(v.jsxs)("div",{className:"message-sub-info",children:[h,m,0!=l?Object(v.jsx)("p",{children:Object(v.jsx)(y.a,{date:l,locale:"en-US"})}):null,e.streak_num>0?Object(v.jsxs)("p",{children:[e.streak_num,e.streak_image]}):null]})]})]})})}Object(h.bindKeyboard)(m.a);var R=[],U={name:"Guest (me)",email:"Guest@project-yellow-ghost.com",friends:["Guest@project-yellow-ghost.com"],streak_emoji:"\ud83d\udd25",photoURL:"https://upload.wikimedia.org/wikipedia/commons/thumb/7/7e/Circle-icons-profile.svg/2048px-Circle-icons-profile.svg.png"},L=function(e){Object(o.a)(s,e);var t=Object(d.a)(s);function s(e){var n;return Object(r.a)(this,s),(n=t.call(this,e)).login=function(){p.signInWithPopup(_).then((function(e){n.setState({logged_in:!0,user_name:e.user.displayName,user_email:e.user.email,user_pic:e.user.photoURL}),f.collection("users").doc(e.user.email).get().then((function(t){t.exists||f.collection("users").doc(e.user.email).set({email:e.user.email,name:e.user.displayName,photoURL:e.user.photoURL,streak_emoji:n.state.streak_image,friends:[e.user.email]}).catch((function(e){console.log("Couldn't write user to DB, error: ",e)})),n.get_friends_list()})).catch((function(e){console.log("Error getting document:",e)}))})).catch((function(e){return console.log(e.message)}))},n.logout=function(){b.a.auth().signOut(),n.setState({logged_in:!1,streak_image:"\ud83d\udd25",user_name:"Guest",user_email:"Guest",user_friends:[U],user_strangers:null,everyone:[U],user_pic:"https://upload.wikimedia.org/wikipedia/commons/thumb/7/7e/Circle-icons-profile.svg/2048px-Circle-icons-profile.svg.png"})},n.check_user=function(){b.a.auth().onAuthStateChanged(function(e){e&&this.setState({user_name:e.displayName,user_email:e.email,user_pic:e.photoURL,logged_in:!0},this.get_friends_list)}.bind(Object(g.a)(n)))},n.get_friends_list=function(){(console.log("Get friends!!!!!"),n.state.logged_in)&&f.collection("users").doc(n.state.user_email).get().then((function(e){e.data().hasOwnProperty("friends")?(R=e.data().friends,n.get_messages()):(R=[n.state.user_email],n.get_messages())}))},n.get_messages=function(){var e=f.collection("users"),t=[],s=[],i=[],a=0,c=0,r=0;e.get().then((function(e){for(var l=0;l<e.docs.length;l++)R.includes(e.docs[l].data().email)?(t[a]=e.docs[l].data(),a+=1):(s[c]=e.docs[l].data(),c+=1),i[r]=e.docs[l].data(),r+=1;n.setState({user_friends:t,user_strangers:s,everyone:i})}))},n.state={logged_in:!1,streak_image:"\ud83d\udd25",user_name:"Guest",user_email:"Guest",user_friends:[U],user_strangers:null,everyone:[U],user_pic:"https://upload.wikimedia.org/wikipedia/commons/thumb/7/7e/Circle-icons-profile.svg/2048px-Circle-icons-profile.svg.png"},n}return Object(l.a)(s,[{key:"componentDidMount",value:function(){this.check_user()}},{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{className:"messages-screen",children:[Object(v.jsx)(S,{user_email:this.state.user_email,user_name:this.state.user_name,user_pic:this.state.user_pic,login:this.login.bind(this),logout:this.logout.bind(this),user_friends:this.state.user_friends,user_strangers:this.state.user_strangers,everyone:this.state.everyone,get_friends_list:this.get_friends_list.bind(this),friends_list:R,logged_in:this.state.logged_in}),Object(v.jsxs)("ul",{className:"messages-list",children:[this.state.logged_in?null:Object(v.jsx)("li",{className:"welcome-statement",children:"Welcome to Project Yellow Ghost, a web app version of SnapChat. This was a project developed by Jonathan Wang and this was his final project for school. Right now, you are on a local guest account for you to try out. Feel free to sign in at the top if you want to start using this product. Happy Snapping!"}),this.state.user_friends.map((function(t){return Object(v.jsx)(C,{sender_email:t.email,profile_url:t.photoURL,sender_name:t.name,user_email:e.state.user_email,streak_image:e.state.streak_image,logged_in:e.state.logged_in})}))]})]})}}]),s}(n.Component),A=s(47),G=s.n(A),E=s(107),F=(s(99),function(e){Object(o.a)(s,e);var t=Object(d.a)(s);function s(e){var n;return Object(r.a)(this,s),(n=t.call(this,e)).update=function(){n.setState({width:window.innerWidth,height:window.innerHeight,faceMode:"user"})},n.send=function(){var e=b.a.auth().currentUser,t=Object(E.a)(),s=e.email,i=e.displayName,a=[s];O.ref("posts/".concat(t)).putString(n.state.image,"data_url").on("state_changed",(function(e){}),(function(e){console.log(e)}),(function(){var e=0;for(e=0;e<a.length;e++){console.log(typeof a[e],a[e]);var c=a[e];O.ref("posts").child(t).getDownloadURL().then((function(e){f.collection("posts").doc(c).collection("Received").doc(t).set({imageURL:e,id:t,email:s,name:i,avatarURL:"https://upload.wikimedia.org/wikipedia/commons/thumb/7/7e/Circle-icons-profile.svg/2048px-Circle-icons-profile.svg.png",read:!1,timeStamp:b.a.firestore.FieldValue.serverTimestamp(),to:a}),console.log("Photo Sent"),n.setState({image:null,screen:"camera"})}))}f.collection("posts").doc(s).collection("Sent").doc(t).set({id:t,email:s,timeStamp:b.a.firestore.FieldValue.serverTimestamp(),to:a})}))},n.close=function(){n.setState({image:null,screen:"camera"})},n.send_to=function(){n.setState({screen:"send_to"})},n.capture=function(){var e=n.webcam.getScreenshot();n.setState({image:e,screen:"captured"})},n.setRef=function(e){n.webcam=e},n.state={width:window.innerWidth,height:window.innerHeight,image:null,screen:"camera"},window.addEventListener("resize",n.update),n}return Object(l.a)(s,[{key:"render",value:function(){return Object(v.jsxs)(v.Fragment,{children:["camera"===this.state.screen?Object(v.jsxs)("div",{className:"cam-tab",children:[Object(v.jsx)(G.a,{ref:this.setRef,videoConstraints:{facingMode:this.state.faceMode,width:this.state.width,height:this.state.height},screenshotFormat:"image/jpeg",audio:!1,mirrored:!0,className:"webcam"}),Object(v.jsx)("button",{className:"capture",onClick:this.capture,children:"Capture"})]}):null,"captured"===this.state.screen&&this.state.image?Object(v.jsxs)("div",{className:"cam-tab",children:[Object(v.jsx)("img",{src:this.state.image}),Object(v.jsx)("button",{className:"capture",onClick:this.send_to,children:"Send to"}),Object(v.jsx)("button",{className:"send",onClick:this.close,children:"Close"})]}):null,"send_to"===this.state.screen&&this.state.image?Object(v.jsxs)("div",{className:"user-list",children:[Object(v.jsx)("button",{className:"send",onClick:this.send,children:"Send"}),Object(v.jsx)("button",{className:"capture",onClick:this.close,children:"Close"})]}):null]})}}]),s}(n.Component)),D=Object(h.bindKeyboard)(m.a),I=function(e){Object(o.a)(s,e);var t=Object(d.a)(s);function s(e){var n;return Object(r.a)(this,s),(n=t.call(this,e)).update=function(){n.setState({width:window.innerWidth,height:window.innerHeight})},n.state={index:0,height:window.innerHeight,width:window.innerWidth},window.addEventListener("resize",n.update),n}return Object(l.a)(s,[{key:"render",value:function(){return Object(v.jsxs)(D,{enableMouseEvents:!0,style:Object.assign({width:this.state.width,height:this.state.height,position:"absolute",top:"0%",left:"0%"}),children:[Object(v.jsxs)("div",{style:Object.assign({backgroundColor:"white",minHeight:"100vh",width:"100%"}),children:[Object(v.jsx)(u.a,{children:Object(v.jsx)("meta",{name:"viewport",content:"height=device-height, width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"})}),Object(v.jsx)(L,{})]}),Object(v.jsxs)("div",{style:Object.assign({backgroundColor:"Plum"}),children:[Object(v.jsx)(u.a,{children:Object(v.jsx)("meta",{name:"viewport",content:"height=device-height, width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes"})}),Object(v.jsx)(F,{})]})]})}}]),s}(i.a.Component);c.a.render(Object(v.jsx)(I,{}),document.getElementById("root"))},24:function(e,t,s){},92:function(e,t,s){},99:function(e,t,s){}},[[100,1,2]]]);
//# sourceMappingURL=main.27dba765.chunk.js.map